<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pioneer Feeders — Operations Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <style>
    :root {
      --bg:#080b12;--bg-card:#0f1520;--bg-row:#111827;--bg-hover:#161f30;
      --border:#1a2235;--border-light:#243049;
      --text:#e2e8f0;--text-2:#94a3b8;--text-3:#64748b;
      --green:#22c55e;--green-dim:rgba(34,197,94,0.08);--green-b:rgba(34,197,94,0.2);
      --yellow:#eab308;--yellow-dim:rgba(234,179,8,0.08);--yellow-b:rgba(234,179,8,0.2);
      --red:#ef4444;--red-dim:rgba(239,68,68,0.08);--red-b:rgba(239,68,68,0.2);
      --blue:#38bdf8;--purple:#818cf8;--teal:#2dd4bf;--orange:#fb923c;--amber:#fbbf24;--pink:#f472b6;
      --chewy:#1C49C2;--amazon:#FF9900;--shopify:#96bf48;
      --ebay-blue:#0064D2;--ebay-red:#e53238;--ebay-yellow:#f5af02;--ebay-green:#86b817;
      --ups-brown:#351C15;--ups-gold:#FFB500;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh}

    .header{background:var(--bg-card);border-bottom:1px solid var(--border);padding:14px 32px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;backdrop-filter:blur(12px);gap:12px;flex-wrap:wrap}
    .header-left{display:flex;align-items:center;gap:20px}
    .brand{font-size:12px;font-weight:700;letter-spacing:2.5px;text-transform:uppercase;color:var(--text-3)}.brand b{color:var(--blue)}
    .header-nav{display:flex;gap:4px}
    .nav-btn{padding:7px 14px;background:transparent;border:1px solid transparent;border-radius:7px;color:var(--text-2);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:500;cursor:pointer}
    .nav-btn:hover{background:rgba(56,189,248,0.05)}.nav-btn.active{background:rgba(56,189,248,0.1);border-color:rgba(56,189,248,0.2);color:var(--blue)}
    .date-controls{position:relative}
    .date-btn{display:flex;align-items:center;gap:8px;padding:7px 14px;background:var(--bg-card);border:1px solid var(--border);border-radius:8px;color:var(--text-2);font-family:'JetBrains Mono',monospace;font-size:12px;cursor:pointer;transition:all .2s}
    .date-btn:hover,.date-btn.open{border-color:var(--blue);color:var(--blue)}
    .date-btn svg{width:14px;height:14px;opacity:.6}
    .date-btn.open svg{opacity:1}
    .date-dd{position:absolute;top:calc(100% + 8px);right:0;background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:16px;width:320px;box-shadow:0 20px 50px rgba(0,0,0,.5);z-index:200;display:none}
    .date-dd.show{display:block}
    .dd-label{font-size:9px;font-weight:600;letter-spacing:1.2px;text-transform:uppercase;color:var(--text-3);margin-bottom:8px}
    .dd-presets{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-bottom:14px}
    .dd-preset{padding:6px;background:transparent;border:1px solid var(--border);border-radius:6px;color:var(--text-2);font-family:'DM Sans',sans-serif;font-size:11px;font-weight:500;cursor:pointer;text-align:center;transition:all .15s}
    .dd-preset:hover{border-color:var(--border-light);background:var(--bg-hover)}
    .dd-preset.active{background:rgba(56,189,248,0.1);border-color:var(--blue);color:var(--blue)}
    .dd-divider{border:none;border-top:1px solid var(--border);margin:12px 0}
    .dd-row{display:flex;gap:8px;align-items:center;margin-bottom:8px}
    .dd-input{flex:1;background:var(--bg);border:1px solid var(--border);border-radius:6px;padding:8px 10px;color:var(--text);font-family:'JetBrains Mono',monospace;font-size:12px}
    .dd-input:focus{outline:none;border-color:var(--blue)}
    .dd-arrow{color:var(--text-3);font-size:14px}
    .dd-apply{width:100%;padding:8px;background:rgba(56,189,248,0.15);border:1px solid rgba(56,189,248,0.3);border-radius:6px;color:var(--blue);font-family:'DM Sans',sans-serif;font-size:12px;font-weight:600;cursor:pointer;transition:all .15s}
    .dd-apply:hover{background:rgba(56,189,248,0.25)}
    .date-overlay{position:fixed;inset:0;z-index:199;display:none}
    .date-overlay.show{display:block}
    .logout-btn{display:flex;align-items:center;justify-content:center;width:34px;height:34px;background:transparent;border:1px solid var(--border);border-radius:8px;color:var(--text-3);cursor:pointer;transition:all .2s;margin-left:6px}
    .logout-btn:hover{border-color:var(--red-b);color:var(--red);background:var(--red-dim)}

    .main{padding:20px 32px;max-width:1500px;margin:0 auto}
    .section{display:none}.section.active{display:block}

    .kpi-row{display:grid;grid-template-columns:repeat(6,1fr);gap:12px;margin-bottom:20px}
    .kpi{background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px 18px;position:relative;overflow:hidden;transition:border-color .2s}
    .kpi:hover{border-color:var(--border-light)}
    .kpi-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    .kpi-label{font-size:10px;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:var(--text-3)}
    .kpi-status{width:8px;height:8px;border-radius:50%}
    .kpi-value{font-size:24px;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
    .kpi-bottom{display:flex;align-items:center;justify-content:space-between;margin-top:8px}
    .kpi-sub{font-size:11px;color:var(--text-3)}
    .kpi-trend{font-size:11px;font-weight:600;display:flex;align-items:center;gap:2px}
    .kpi-trend svg{width:12px;height:12px}
    .kpi-accent{position:absolute;bottom:0;left:0;right:0;height:2px}

    .sec{display:flex;align-items:center;gap:10px;margin:24px 0 14px}
    .sec-dot{width:6px;height:6px;border-radius:50%}
    .sec-label{font-size:10px;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--text-3)}
    .sec-line{flex:1;height:1px;background:var(--border)}
    .sec-note{font-size:10px;color:var(--text-3);font-weight:400}

    .sc{width:100%;border-collapse:separate;border-spacing:0;background:var(--bg-card);border-radius:10px;overflow:hidden;border:1px solid var(--border);margin-bottom:12px}
    .sc th{text-align:left;padding:8px 14px;font-size:9px;font-weight:600;letter-spacing:1.2px;text-transform:uppercase;color:var(--text-3);background:rgba(17,24,39,0.6);border-bottom:1px solid var(--border)}
    .sc td{padding:10px 14px;border-bottom:1px solid rgba(26,34,53,0.5);font-size:13px;color:var(--text-2);vertical-align:middle}
    .sc tr:last-child td{border-bottom:none}.sc tr:hover td{background:var(--bg-hover)}
    .sc .mn{color:var(--text);font-weight:600}.sc .ms{font-size:10px;color:var(--text-3);margin-top:1px}
    .mono{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:500}
    .mono-s{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--text-3)}
    .st{display:inline-flex;align-items:center;justify-content:center;min-width:54px;height:22px;border-radius:5px;font-size:9px;font-weight:700;letter-spacing:.4px;text-transform:uppercase}
    .st-g{background:var(--green-dim);color:var(--green);border:1px solid var(--green-b)}
    .st-y{background:var(--yellow-dim);color:var(--yellow);border:1px solid var(--yellow-b)}
    .st-r{background:var(--red-dim);color:var(--red);border:1px solid var(--red-b)}
    .tr{display:inline-flex;align-items:center;gap:2px;font-size:11px;font-weight:600}
    .tr svg{width:12px;height:12px}
    .tr-u{color:var(--green)}.tr-d{color:var(--red)}.tr-f{color:var(--text-3)}
    .pay{display:inline-flex;align-items:center;gap:3px;padding:2px 7px;border-radius:3px;font-size:9px;font-weight:700;letter-spacing:.3px;text-transform:uppercase}
    .pay-g{background:var(--green-dim);color:var(--green);border:1px solid var(--green-b)}
    .pay-y{background:var(--yellow-dim);color:var(--yellow);border:1px solid var(--yellow-b)}
    .pay-r{background:var(--red-dim);color:var(--red);border:1px solid var(--red-b)}

    .ch-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:16px}
    .ch{background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px;border-left:3px solid var(--border)}
    .ch:hover{border-color:var(--border-light)}
    .ch-name{font-size:13px;font-weight:700;margin-bottom:12px;display:flex;align-items:center;justify-content:space-between}
    .ch-row{display:flex;justify-content:space-between;margin-bottom:6px}
    .ch-metric{font-size:10px;color:var(--text-3);text-transform:uppercase;letter-spacing:.3px}
    .ch-val{font-size:14px;font-weight:700;font-family:'JetBrains Mono',monospace}
    .ch-divider{border:none;border-top:1px solid rgba(26,34,53,.5);margin:10px 0}
    .ch-cups{font-size:11px;color:var(--text-3)}.ch-cups b{color:var(--text-2);font-family:'JetBrains Mono',monospace}

    .cg{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px}
    .cc{background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:18px}
    .cc.full{grid-column:1/-1}
    .ct{font-size:12px;font-weight:600;color:var(--text-3);margin-bottom:12px;letter-spacing:.3px}
    .cw{height:240px;position:relative}
    .cw-tall{height:320px;position:relative}

    .bars{margin:12px 0 16px}
    .bar-r{display:flex;align-items:center;gap:10px;margin-bottom:6px}
    .bar-l{width:150px;font-size:11px;color:var(--text-2);text-align:right;flex-shrink:0}
    .bar-t{flex:1;height:22px;background:rgba(26,34,53,.4);border-radius:4px;overflow:hidden}
    .bar-f{height:100%;border-radius:4px;display:flex;align-items:center;padding-left:8px;font-size:10px;font-weight:600;font-family:'JetBrains Mono',monospace}

    .stats-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;margin-bottom:20px}
    .stat-card{background:var(--bg-card);border:1px solid var(--border);border-radius:10px;padding:16px}
    .stat-label{font-size:10px;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:var(--text-3);margin-bottom:6px}
    .stat-value{font-size:24px;font-weight:800;font-family:'JetBrains Mono',monospace;line-height:1}
    .stat-sub{font-size:11px;color:var(--text-3);margin-top:6px}

    .loading{display:flex;align-items:center;justify-content:center;padding:60px;color:var(--text-3)}
    .spinner{width:24px;height:24px;border:3px solid var(--border);border-top-color:var(--blue);border-radius:50%;animation:spin .8s linear infinite;margin-right:12px}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Tablet */
    @media(max-width:1100px){
      .kpi-row{grid-template-columns:repeat(3,1fr)}
      .ch-grid{grid-template-columns:repeat(2,1fr)}
    }

    /* Small tablet / large phone */
    @media(max-width:768px){
      .header{padding:10px 14px;flex-wrap:wrap;gap:8px}
      .header-left{width:100%;justify-content:space-between}
      .header-nav{overflow-x:auto;-webkit-overflow-scrolling:touch;scrollbar-width:none;gap:2px;flex:1}
      .header-nav::-webkit-scrollbar{display:none}
      .nav-btn{padding:6px 10px;font-size:11px;white-space:nowrap;flex-shrink:0}
      .date-controls{order:3}
      .logout-btn{order:4;width:30px;height:30px}
      .date-btn{padding:6px 10px;font-size:11px}
      .date-dd{right:-10px;width:calc(100vw - 28px);max-width:340px}
      .main{padding:10px 12px}
      .kpi-row{grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:14px}
      .kpi{padding:12px 14px}
      .kpi-value{font-size:18px}
      .kpi-label{font-size:9px;letter-spacing:.6px}
      .kpi-sub{font-size:10px}
      .ch-grid{grid-template-columns:1fr 1fr;gap:8px}
      .ch{padding:12px}
      .ch-val{font-size:13px}
      .cg{grid-template-columns:1fr;gap:10px;margin-bottom:12px}
      .cc{padding:14px}
      .cw{height:200px}
      .cw-tall{height:260px}
      .sec{margin:18px 0 10px}
      .sec-label{font-size:9px;letter-spacing:1.5px}
      .stats-grid{grid-template-columns:repeat(2,1fr);gap:8px}
      .stat-card{padding:12px}
      .stat-value{font-size:18px}
      .bar-l{width:100px;font-size:10px}
      .bar-f{font-size:9px;padding-left:6px}
    }

    /* Phone */
    @media(max-width:480px){
      .header-left{gap:8px}
      .brand{font-size:10px;letter-spacing:2px}
      .header-left img{height:28px;width:28px}
      .kpi-row{grid-template-columns:1fr 1fr;gap:6px;margin-bottom:10px}
      .kpi{padding:10px 12px;border-radius:8px}
      .kpi-value{font-size:16px}
      .kpi-top{margin-bottom:6px}
      .kpi-label{font-size:8px}
      .ch-grid{grid-template-columns:1fr;gap:8px}
      .ch-name{font-size:12px}
      .ch-name svg{max-width:44px;height:auto}
      .pay{font-size:8px;padding:2px 5px}
      .stats-grid{grid-template-columns:1fr 1fr;gap:6px}
      .stat-card{padding:10px}
      .stat-value{font-size:16px}
      .stat-label{font-size:9px}
      .cw{height:180px}
      .cw-tall{height:220px}
      .ct{font-size:11px}
      .bar-l{width:80px;font-size:9px}
      .dd-presets{grid-template-columns:repeat(4,1fr);gap:4px}
      .dd-preset{padding:5px;font-size:10px}
    }

    /* Very small phone */
    @media(max-width:360px){
      .main{padding:8px}
      .kpi-value{font-size:14px}
      .kpi{padding:8px 10px}
      .nav-btn{padding:5px 8px;font-size:10px}
      .stat-value{font-size:14px}
    }
  </style>
</head>
<body>
<div class="header">
  <div class="header-left">
    <img src="data:image/png;base64,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" alt="Pioneer Feeders" style="height:36px;width:36px;border-radius:50%">
    <div class="brand">Pioneer <b>Feeders</b></div>
    <div class="header-nav">
      <button class="nav-btn active" onclick="showSection('sales', this)">Sales</button>
      <button class="nav-btn" onclick="showSection('shipping', this)">Shipping</button>
      <button class="nav-btn" onclick="showSection('breeding', this)">Hornworm Breeding</button>
      <button class="nav-btn" onclick="showSection('forecast', this)">Demand Forecast</button>
    </div>
  </div>
  <div class="date-controls">
    <div class="date-overlay" id="dateOverlay" onclick="closeDatePicker()"></div>
    <button class="date-btn" id="dateBtn" onclick="toggleDatePicker()">
      <svg viewBox="0 0 16 16" fill="none"><rect x="2" y="3" width="12" height="11" rx="2" stroke="currentColor" stroke-width="1.5"/><path d="M2 7h12M5 1v3M11 1v3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      <span id="dateLabel">Last 7 days</span>
      <svg viewBox="0 0 16 16" fill="none" style="width:10px;height:10px"><path d="M4 6l4 4 4-4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </button>
    <div class="date-dd" id="dateDd">
      <div class="dd-label">Quick Select</div>
      <div class="dd-presets">
        <button class="dd-preset active" onclick="pickPreset('7d', this)">7 Days</button>
        <button class="dd-preset" onclick="pickPreset('14d', this)">14 Days</button>
        <button class="dd-preset" onclick="pickPreset('30d', this)">30 Days</button>
        <button class="dd-preset" onclick="pickPreset('90d', this)">90 Days</button>
      </div>
      <div class="dd-presets" style="grid-template-columns:repeat(3,1fr)">
        <button class="dd-preset" onclick="pickPreset('thisWeek', this)">This Week</button>
        <button class="dd-preset" onclick="pickPreset('thisMonth', this)">This Month</button>
        <button class="dd-preset" onclick="pickPreset('lastMonth', this)">Last Month</button>
      </div>
      <hr class="dd-divider">
      <div class="dd-label">Custom Range</div>
      <div class="dd-row">
        <input type="date" class="dd-input" id="ddStart">
        <span class="dd-arrow">→</span>
        <input type="date" class="dd-input" id="ddEnd">
      </div>
      <button class="dd-apply" onclick="applyCustomRange()">Apply Range</button>
    </div>
  </div>
  <button class="logout-btn" onclick="logout()" title="Sign Out">
    <svg viewBox="0 0 16 16" width="14" height="14" fill="none"><path d="M6 2H4a2 2 0 00-2 2v8a2 2 0 002 2h2M11 11l3-3-3-3M6 8h8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
  </button>
</div>

<div class="main">

  <!-- ========== SALES SECTION ========== -->
  <div class="section active" id="sec-sales">
    <div id="sales-loading" class="loading"><div class="spinner"></div>Loading sales data...</div>
    <div id="sales-content" style="display:none">
      <div id="sales-kpis" class="kpi-row"></div>

      <div class="cc full" style="margin-bottom:16px">
        <div class="ct">Daily Revenue & Cups Sold</div>
        <div class="cw"><canvas id="chart-daily-sales"></canvas></div>
      </div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--teal)"></span>
        <span class="sec-label">Retail Channels</span>
        <span class="sec-line"></span>
      </div>
      <div id="sales-channels" class="ch-grid"></div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--purple)"></span>
        <span class="sec-label">Wholesale</span>
        <span class="sec-line"></span>
      </div>
      <div id="sales-wholesale" class="stats-grid"></div>

      <div class="cg">
        <div class="cc">
          <div class="ct">Revenue by Channel</div>
          <div class="cw"><canvas id="chart-channel"></canvas></div>
        </div>
        <div class="cc">
          <div class="ct">Cups by Product Type</div>
          <div class="cw"><canvas id="chart-cups"></canvas></div>
        </div>
      </div>
      <div class="cg">
        <div class="cc">
          <div class="ct">Channel Cup Breakdown</div>
          <div class="cw"><canvas id="chart-channel-cups"></canvas></div>
        </div>
        <div class="cc">
          <div class="ct">Wholesale vs Retail</div>
          <div class="cw"><canvas id="chart-tier"></canvas></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== SHIPPING SECTION ========== -->
  <div class="section" id="sec-shipping">
    <div id="shipping-loading" class="loading"><div class="spinner"></div>Loading shipping data...</div>
    <div id="shipping-content" style="display:none">
      <div class="sec" style="margin-top:0">
        <span class="sec-dot" style="background:var(--ups-gold)"></span>
        <span class="sec-label" style="display:flex;align-items:center;gap:6px"><svg viewBox="0 0 24 28" width="16" height="19"><path d="M12 1C6 1 2 4 2 4v12c0 6 10 11 10 11s10-5 10-11V4s-4-3-10-3z" fill="#351C15"/><path d="M12 3C7 3 4 5.5 4 5.5v10.5c0 5 8 9 8 9s8-4 8-9V5.5S17 3 12 3z" fill="#FFB500"/></svg>UPS Shipping Report</span>
        <span class="sec-line"></span>
        <span class="sec-note">excl. Chewy (FedEx 3rd party, $0)</span>
      </div>
      <div id="shipping-stats" class="stats-grid"></div>
      <div id="shipping-bars"></div>
      <div class="cg">
        <div class="cc full">
          <div class="ct">Daily Shipping Cost & Shipments</div>
          <div class="cw"><canvas id="chart-daily-shipping"></canvas></div>
        </div>
      </div>
      <div class="cg">
        <div class="cc">
          <div class="ct">Cost by Service</div>
          <div class="cw"><canvas id="chart-service"></canvas></div>
        </div>
        <div class="cc">
          <div class="ct">Shipments by State</div>
          <div class="cw"><canvas id="chart-state"></canvas></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== BREEDING SECTION ========== -->
  <div class="section" id="sec-breeding">
    <div class="sec" style="margin-top:0">
      <span class="sec-dot" style="background:var(--green)"></span>
      <span class="sec-label">Hornworm Breeding Dashboard</span>
      <span class="sec-line"></span>
    </div>
    <div id="breeding-loading" class="loading"><div class="spinner"></div>Loading breeding data...</div>
    <div id="breeding-content" style="display:none">
      <div class="stats-grid" id="breeding-stats"></div>
      <div class="cc full" style="margin-bottom:16px">
        <div class="ct">Egg Production — Actual vs Predicted</div>
        <div style="font-size:11px;color:var(--text-3);margin-bottom:10px">
          Model: 500 eggs/female · 85% collection rate · 50% female ratio · 15% pre-emergence mortality · emergence days 4-6 · gamma curve peaking night 8
          <br><span style="color:var(--green)">●</span> Real collection &nbsp; <span style="color:var(--red)">●</span> Interpolated (skipped day) &nbsp; <span style="color:var(--purple)">┈</span> Predicted
        </div>
        <div class="cw-tall"><canvas id="chart-egg-prediction"></canvas></div>
      </div>
      <div class="cg">
        <div class="cc full"><div class="ct">Daily Egg Collection (Weight & Count)</div><div class="cw"><canvas id="chart-eggs"></canvas></div></div>
      </div>
      <div class="cg">
        <div class="cc full"><div class="ct">Daily Pre-Pupae Collection & Mortality</div><div class="cw"><canvas id="chart-prepupae"></canvas></div></div>
      </div>
      <div class="cc" style="margin-bottom:16px"><div class="ct">Mortality Rate by Shelf</div><div class="cw-tall"><canvas id="chart-shelf-mortality"></canvas></div></div>
    </div>
  </div>

  <!-- ========== DEMAND FORECAST SECTION ========== -->
  <div class="section" id="sec-forecast">
    <div id="forecast-loading" class="loading"><div class="spinner"></div>Loading demand forecast...</div>
    <div id="forecast-content" style="display:none">

      <div id="forecast-kpis" class="kpi-row" style="grid-template-columns:repeat(4,1fr)"></div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--orange)"></span>
        <span class="sec-label">Weekly Pour Planner</span>
        <span class="sec-line"></span>
        <span class="sec-note">Next 4 Wednesdays · includes 10% safety + 76 cup shrinkage</span>
      </div>
      <div id="forecast-planner" class="stats-grid" style="grid-template-columns:repeat(4,1fr)"></div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--teal)"></span>
        <span class="sec-label">Monthly Demand by Channel</span>
        <span class="sec-line"></span>
      </div>
      <div class="cg">
        <div class="cc">
          <div class="ct">Chewy Forecast (Physical Cups)</div>
          <div class="cw"><canvas id="chart-chewy-forecast"></canvas></div>
        </div>
        <div class="cc">
          <div class="ct">Channel Demand Split (This Month)</div>
          <div class="cw"><canvas id="chart-demand-split"></canvas></div>
        </div>
      </div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--green)"></span>
        <span class="sec-label">Historical Supply vs Demand</span>
        <span class="sec-line"></span>
      </div>
      <div class="cg">
        <div class="cc full">
          <div class="ct">Weekly Cups Poured (Sellable) vs Estimated Demand</div>
          <div class="cw-tall"><canvas id="chart-pour-history"></canvas></div>
        </div>
      </div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--purple)"></span>
        <span class="sec-label">Amazon Sales Trend</span>
        <span class="sec-line"></span>
      </div>
      <div class="cg">
        <div class="cc full">
          <div class="ct">Amazon Monthly Units & Revenue</div>
          <div class="cw"><canvas id="chart-amazon-trend"></canvas></div>
        </div>
      </div>

      <div class="sec">
        <span class="sec-dot" style="background:var(--red)"></span>
        <span class="sec-label">Forecast Accuracy</span>
        <span class="sec-line"></span>
        <span class="sec-note">Forecasted demand vs actual sales · updated nightly</span>
      </div>
      <div id="forecast-accuracy" style="overflow-x:auto"></div>
      <div class="cg" style="margin-top:16px">
        <div class="cc full">
          <div class="ct">Forecast vs Actual (Weekly)</div>
          <div class="cw-tall"><canvas id="chart-accuracy"></canvas></div>
        </div>
      </div>

    </div>
  </div>

</div>

<script>
  let currentSection = 'sales';
  let startDate, endDate;
  const charts = {};

  Chart.defaults.color = '#64748b';
  Chart.defaults.borderColor = '#1a2235';
  Chart.defaults.font.family = "'DM Sans',sans-serif";
  Chart.defaults.font.size = 11;
  Chart.defaults.plugins.legend.labels.boxWidth = 10;
  Chart.defaults.plugins.legend.labels.padding = 12;

  function setPreset(preset, el) {
    const end = new Date(); let start = new Date();
    start.setDate(end.getDate() - parseInt(preset) + 1);
    startDate = fmt(start); endDate = fmt(end);
    refreshData();
  }
  function fmt(d) { return d.toISOString().split('T')[0]; }

  // Date picker dropdown
  function toggleDatePicker() {
    const dd = document.getElementById('dateDd');
    const ov = document.getElementById('dateOverlay');
    const btn = document.getElementById('dateBtn');
    const isOpen = dd.classList.contains('show');
    dd.classList.toggle('show');
    ov.classList.toggle('show');
    btn.classList.toggle('open');
    if (!isOpen) {
      document.getElementById('ddStart').value = startDate;
      document.getElementById('ddEnd').value = endDate;
    }
  }
  function closeDatePicker() {
    document.getElementById('dateDd').classList.remove('show');
    document.getElementById('dateOverlay').classList.remove('show');
    document.getElementById('dateBtn').classList.remove('open');
  }

  function updateDateLabel(text) {
    document.getElementById('dateLabel').textContent = text;
  }

  function pickPreset(key, el) {
    const end = new Date(); let start = new Date();
    let label = '';
    document.querySelectorAll('.dd-preset').forEach(b => b.classList.remove('active'));
    if (el) el.classList.add('active');

    if (key === '7d') { start.setDate(end.getDate() - 6); label = 'Last 7 days'; }
    else if (key === '14d') { start.setDate(end.getDate() - 13); label = 'Last 14 days'; }
    else if (key === '30d') { start.setDate(end.getDate() - 29); label = 'Last 30 days'; }
    else if (key === '90d') { start.setDate(end.getDate() - 89); label = 'Last 90 days'; }
    else if (key === 'thisWeek') {
      const day = end.getDay(); const diff = day === 0 ? 6 : day - 1;
      start = new Date(end); start.setDate(end.getDate() - diff);
      label = 'This week';
    }
    else if (key === 'thisMonth') {
      start = new Date(end.getFullYear(), end.getMonth(), 1);
      label = 'This month';
    }
    else if (key === 'lastMonth') {
      start = new Date(end.getFullYear(), end.getMonth() - 1, 1);
      const lmEnd = new Date(end.getFullYear(), end.getMonth(), 0);
      startDate = fmt(start); endDate = fmt(lmEnd);
      updateDateLabel('Last month');
      closeDatePicker();
      refreshData();
      return;
    }

    startDate = fmt(start); endDate = fmt(end);
    updateDateLabel(label);
    closeDatePicker();
    refreshData();
  }

  function applyCustomRange() {
    const s = document.getElementById('ddStart').value;
    const e = document.getElementById('ddEnd').value;
    if (!s || !e) return;
    startDate = s; endDate = e;
    document.querySelectorAll('.dd-preset').forEach(b => b.classList.remove('active'));
    const sShort = new Date(s+'T12:00:00').toLocaleDateString('en-US', {month:'short',day:'numeric'});
    const eShort = new Date(e+'T12:00:00').toLocaleDateString('en-US', {month:'short',day:'numeric'});
    updateDateLabel(sShort + ' – ' + eShort);
    closeDatePicker();
    refreshData();
  }

  function showSection(name, el) {
    currentSection = name;
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(`sec-${name}`).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    if (el) el.classList.add('active');
    refreshData();
  }

  async function api(path) {
    const res = await fetch(`/dashboard/api${path}`);
    if (res.status === 401) { window.location.reload(); return null; }
    return res.json();
  }

  async function logout() {
    try { await fetch('/dashboard/api/logout', { method: 'POST' }); } catch(e) {}
    document.cookie = 'dashboard_auth=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';
    window.location.reload();
  }

  function refreshData() {
    if (currentSection === 'sales') loadSales();
    else if (currentSection === 'shipping') loadShipping();
    else if (currentSection === 'breeding') loadBreeding();
    else if (currentSection === 'forecast') loadForecast();
  }

  // ============================================================
  // SALES
  // ============================================================
  async function loadSales() {
    show('sales-loading'); hide('sales-content');
    try {
      const [summary, daily] = await Promise.all([
        api(`/sales/summary?start_date=${startDate}&end_date=${endDate}`),
        api(`/sales/daily?start_date=${startDate}&end_date=${endDate}`),
      ]);
      if (!summary || !summary.totalOrders) {
        document.getElementById('sales-loading').innerHTML = '<div style="color:var(--text-3)">No sales data for this date range</div>';
        return;
      }

      const retailRev = summary.byTier['tier-retail']?.revenue || 0;
      const wholesaleRev = summary.byTier['tier-wholesale']?.revenue || 0;
      const totalRev = summary.totalRevenue || 0;
      const hwCups = summary.cupsSold?.hornworm || 0;
      const swCups = summary.cupsSold?.silkworm || 0;
      const ch = summary.byChannel || {};
      const chewyRev = ch.chewy?.revenue || 0;
      const amazonRev = (ch['amazon-upnorth']?.revenue || 0) + (ch['amazon-pioneer']?.revenue || 0);
      const webRev = ch.retail?.revenue || 0;
      const ebayRev = ch.ebay?.revenue || 0;
      const chewyCups = ch.chewy?.cups || 0;
      const amazonCups = (ch['amazon-upnorth']?.cups || 0) + (ch['amazon-pioneer']?.cups || 0);
      const webCups = ch.retail?.cups || 0;
      const ebayCups = ch.ebay?.cups || 0;

      document.getElementById('sales-kpis').innerHTML = `
        ${kpiCard('Total Revenue', '$'+n(totalRev), summary.totalOrders+' orders', 'green', 'green')}
        ${kpiCard('Net Profit', '$'+n(totalRev * 0.747), (74.7).toFixed(1)+'% margin', 'green', 'green')}
        ${kpiCard('Hornworm Cups', n(hwCups,0), 'physical cups', 'green', 'green')}
        ${kpiCard('Silkworm Cups', n(swCups,0), 'physical cups', 'green', 'green')}
        ${kpiCard('<span style="display:flex;align-items:center;gap:4px"><svg viewBox="0 0 24 28" width="12" height="14"><path d="M12 1C6 1 2 4 2 4v12c0 6 10 11 10 11s10-5 10-11V4s-4-3-10-3z" fill="#351C15"/><path d="M12 3C7 3 4 5.5 4 5.5v10.5c0 5 8 9 8 9s8-4 8-9V5.5S17 3 12 3z" fill="#FFB500"/></svg>UPS Allocation</span>', '—', 'see shipping tab', 'yellow', 'ups-gold')}
        ${kpiCard('Avg Order Value', '$'+n(totalRev / (summary.totalOrders||1)), 'per order', 'green', 'green')}
      `;

      document.getElementById('sales-channels').innerHTML = `
        <div class="ch" style="border-left-color:var(--chewy)">
          <div class="ch-name"><span style="color:var(--chewy)"><svg viewBox="0 0 100 28" width="56" height="16"><text x="0" y="22" font-family="Arial,sans-serif" font-weight="900" font-size="24" fill="#1C49C2">chewy</text></svg></span><span class="pay pay-r">45 Day Pay</span></div>
          <div class="ch-row"><div><div class="ch-metric">Sales</div><div class="ch-val" style="color:var(--chewy)">$${n(chewyRev)}</div></div><div><div class="ch-metric">Cups</div><div class="ch-val">${n(chewyCups,0)}</div></div></div>
        </div>
        <div class="ch" style="border-left-color:var(--amazon)">
          <div class="ch-name"><span style="color:var(--amazon)"><svg viewBox="0 0 120 30" width="66" height="16"><text x="0" y="20" font-family="Arial,sans-serif" font-weight="900" font-size="20" fill="#FF9900">amazon</text><path d="M8 25 Q60 31 112 25" stroke="#FF9900" stroke-width="2.5" fill="none" stroke-linecap="round"/></svg></span><span class="pay pay-y">2 Wk Bulk</span></div>
          <div class="ch-row"><div><div class="ch-metric">Sales</div><div class="ch-val" style="color:var(--amazon)">$${n(amazonRev)}</div></div><div><div class="ch-metric">Cups</div><div class="ch-val">${n(amazonCups,0)}</div></div></div>
        </div>
        <div class="ch" style="border-left-color:var(--shopify)">
          <div class="ch-name"><span style="color:var(--shopify)"><svg viewBox="0 0 20 23" width="14" height="16"><path d="M15.7 5.5c0-.1-.1-.2-.3-.2s-1.8-.1-1.8-.1-1.2-1.2-1.4-1.3c-.1-.1-.2-.1-.3-.1l-.8 12.7 4.5-1s-.9-9.9-.9-10zm-5.3 2.2l-.6 1.8s-.7-.4-1.6-.3c-1.2.1-1.2.8-1.2 1 .1 1 2.7 1.2 2.9 3.6.1 1.9-1 3.2-2.6 3.3-1.9.1-3-1-3-1l.4-1.7s1.1.8 1.9.7c.6 0 .8-.4.8-.7-.1-1.3-2.2-1.2-2.4-3.4-.1-1.9 1.1-3.8 3.8-4 1-.1 1.6.3 1.6.3z" fill="#96bf48"/></svg> Website</span><span class="pay pay-g">Immediate</span></div>
          <div class="ch-row"><div><div class="ch-metric">Sales</div><div class="ch-val" style="color:var(--shopify)">$${n(webRev)}</div></div><div><div class="ch-metric">Cups</div><div class="ch-val">${n(webCups,0)}</div></div></div>
        </div>
        <div class="ch" style="border-left-color:var(--ebay-blue)">
          <div class="ch-name"><span><svg viewBox="0 0 70 24" width="46" height="15"><text x="0" y="19" font-family="Arial,sans-serif" font-weight="900" font-size="22"><tspan fill="#e53238">e</tspan><tspan fill="#0064D2">b</tspan><tspan fill="#f5af02">a</tspan><tspan fill="#86b817">y</tspan></text></svg></span><span class="pay pay-y">2\u20133 Days</span></div>
          <div class="ch-row"><div><div class="ch-metric">Sales</div><div class="ch-val" style="color:var(--ebay-blue)">$${n(ebayRev)}</div></div><div><div class="ch-metric">Cups</div><div class="ch-val">${n(ebayCups,0)}</div></div></div>
        </div>
      `;

      const wsOrders = summary.byTier['tier-wholesale']?.orders || 0;
      const wsCups = summary.byTier['tier-wholesale']?.cups || 0;
      document.getElementById('sales-wholesale').innerHTML = `
        ${statCard('Wholesale Revenue', '$'+n(wholesaleRev), wsOrders+' orders', '--purple')}
        ${statCard('Wholesale Cups', n(wsCups,0), 'physical cups', '--purple')}
      `;

      if (daily && daily.length) {
        makeChart('chart-daily-sales', 'bar', {
          labels: daily.map(d => shortDate(d.date)),
          datasets: [
            { label: 'Revenue', data: daily.map(d => d.revenue), backgroundColor: 'rgba(34,197,94,0.5)', borderRadius: 4, yAxisID: 'y', order: 2 },
            { label: 'Cups', data: daily.map(d => d.cups), type: 'line', borderColor: '#fb923c', backgroundColor: 'transparent', tension: 0.3, pointRadius: 3, pointBackgroundColor: '#fb923c', yAxisID: 'y1', order: 1, borderWidth: 2 },
          ]
        }, { y: { position: 'left', title: { display: true, text: 'Revenue ($)' } }, y1: { position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Cups' } } });
      }

      const channels = Object.entries(summary.byChannel).filter(([,v]) => v.revenue > 0);
      if (channels.length) {
        const channelColors = { retail: '#96bf48', wholesale: '#818cf8', chewy: '#1C49C2', 'amazon-pioneer': '#FF9900', 'amazon-upnorth': '#FF9900', ebay: '#0064D2', tradeshow: '#64748b' };
        makeChart('chart-channel', 'doughnut', {
          labels: channels.map(([k]) => channelLabel(k)),
          datasets: [{ data: channels.map(([,v]) => v.revenue), backgroundColor: channels.map(([k]) => channelColors[k] || '#64748b'), borderWidth: 0 }]
        }, {}, { cutout: '68%' });
      }

      const cupTypes = Object.entries(summary.byProductType).filter(([,v]) => v.cups > 0);
      if (cupTypes.length) {
        const typeColors = { 'hornworm-cup': '#ef4444', 'silkworm-cup': '#22c55e', 'waxworm-cup': '#eab308', 'superworm-cup': '#fb923c', 'mealworm-cup': '#818cf8', 'bsfl-cup': '#2dd4bf' };
        makeChart('chart-cups', 'doughnut', {
          labels: cupTypes.map(([k]) => k.replace('-cup', '').replace('-', ' ')),
          datasets: [{ data: cupTypes.map(([,v]) => v.cups), backgroundColor: cupTypes.map(([k]) => typeColors[k] || '#64748b'), borderWidth: 0 }]
        }, {}, { cutout: '68%' });
      }

      if (channels.length) {
        makeChart('chart-channel-cups', 'bar', {
          labels: channels.map(([k]) => channelLabel(k)),
          datasets: [
            { label: 'Hornworm', data: channels.map(([,v]) => v.cupsByType?.['hornworm-cup'] || 0), backgroundColor: 'rgba(239,68,68,0.6)', borderRadius: 3 },
            { label: 'Silkworm', data: channels.map(([,v]) => v.cupsByType?.['silkworm-cup'] || 0), backgroundColor: 'rgba(34,197,94,0.6)', borderRadius: 3 },
            { label: 'Other', data: channels.map(([,v]) => { const hw=v.cupsByType?.['hornworm-cup']||0; const sw=v.cupsByType?.['silkworm-cup']||0; return Math.max(0,(v.cups||0)-hw-sw); }), backgroundColor: 'rgba(234,179,8,0.4)', borderRadius: 3 },
          ]
        }, { x: { stacked: true }, y: { stacked: true, beginAtZero: true } });
      }

      makeChart('chart-tier', 'bar', {
        labels: ['Wholesale', 'Retail'],
        datasets: [{ label: 'Revenue', data: [wholesaleRev, retailRev], backgroundColor: ['rgba(129,140,248,0.7)', 'rgba(150,191,72,0.7)'], borderRadius: 6 }]
      }, { y: { beginAtZero: true }, x: {} }, { indexAxis: 'y' });

      hide('sales-loading'); show('sales-content');
    } catch (err) {
      console.error('Sales load error:', err);
      document.getElementById('sales-loading').innerHTML = '<div style="color:var(--red)">Failed to load sales data</div>';
    }
  }

  // ============================================================
  // SHIPPING
  // ============================================================
  async function loadShipping() {
    show('shipping-loading'); hide('shipping-content');
    try {
      const [summary, daily, byService, byState] = await Promise.all([
        api(`/shipping/summary?start_date=${startDate}&end_date=${endDate}`),
        api(`/shipping/daily?start_date=${startDate}&end_date=${endDate}`),
        api(`/shipping/by-service?start_date=${startDate}&end_date=${endDate}`),
        api(`/shipping/by-state?start_date=${startDate}&end_date=${endDate}`),
      ]);
      if (!summary) return;

      const custPaid = parseFloat(summary.total_shipping_paid || 0);
      const labelCost = parseFloat(summary.total_label_cost || 0);

      document.getElementById('shipping-stats').innerHTML = `
        ${statCard('Customer Paid Shipping', '$'+n(custPaid), 'what customers paid', '--green')}
        ${statCard('ShipStation Label Cost', '$'+n(labelCost), 'what SS thinks we paid', '--yellow')}
        ${statCard('Shipments', n(summary.total_shipments,0), summary.total_orders+' orders', '--purple')}
        ${statCard('Delivered', n(summary.delivered,0), (summary.in_transit||0)+' in transit', '--green')}
        ${statCard('Late / Exceptions', n(summary.late_deliveries,0)+' / '+n(summary.exceptions,0), '', '--amber')}
      `;

      if (labelCost > 0) {
        const custPct = Math.min(100, (custPaid / labelCost * 100)).toFixed(1);
        document.getElementById('shipping-bars').innerHTML = `
          <div class="cc" style="margin-bottom:16px">
            <div class="ct">Shipping Cost Comparison</div>
            <div class="bars">
              <div class="bar-r"><div class="bar-l">Customer Paid</div><div class="bar-t"><div class="bar-f" style="width:${custPct}%;background:rgba(34,197,94,0.3);color:var(--green)">$${n(custPaid)}</div></div></div>
              <div class="bar-r"><div class="bar-l">ShipStation Labels</div><div class="bar-t"><div class="bar-f" style="width:100%;background:rgba(234,179,8,0.25);color:var(--yellow)">$${n(labelCost)}</div></div></div>
            </div>
          </div>`;
      }

      if (daily && daily.length) {
        makeChart('chart-daily-shipping', 'bar', {
          labels: daily.map(d => shortDate(d.date)),
          datasets: [
            { label: 'Label Cost', data: daily.map(d => parseFloat(d.label_cost)), backgroundColor: 'rgba(129,140,248,0.6)', borderRadius: 4, yAxisID: 'y' },
            { label: 'Shipments', data: daily.map(d => parseInt(d.shipments)), type: 'line', borderColor: '#38bdf8', backgroundColor: 'transparent', tension: 0.3, pointRadius: 3, yAxisID: 'y1' },
          ]
        }, { y: { position: 'left', title: { display: true, text: 'Cost ($)' } }, y1: { position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Shipments' } } });
      }

      if (byService && byService.length) {
        const svcColors = ['rgba(56,189,248,0.7)', 'rgba(129,140,248,0.7)', 'rgba(244,114,182,0.7)', 'rgba(251,191,36,0.7)', 'rgba(52,211,153,0.7)'];
        makeChart('chart-service', 'doughnut', {
          labels: byService.map(s => s.service_code?.replace('ups_', '').replace(/_/g, ' ') || 'unknown'),
          datasets: [{ data: byService.map(s => parseFloat(s.total_cost)), backgroundColor: svcColors, borderWidth: 0 }]
        }, {}, { cutout: '68%' });
      }

      if (byState && byState.length) {
        const top10 = byState.slice(0, 10);
        makeChart('chart-state', 'bar', {
          labels: top10.map(s => s.state),
          datasets: [{ label: 'Shipments', data: top10.map(s => parseInt(s.shipments)), backgroundColor: 'rgba(45,212,191,0.6)', borderRadius: 4 }]
        });
      }

      hide('shipping-loading'); show('shipping-content');
    } catch (err) {
      console.error('Shipping load error:', err);
      document.getElementById('shipping-loading').innerHTML = '<div style="color:var(--red)">Failed to load shipping data</div>';
    }
  }

  // ============================================================
  // BREEDING
  // ============================================================
  async function loadBreeding() {
    show('breeding-loading'); hide('breeding-content');
    try {
      const [eggs, prepupae, prediction] = await Promise.all([
        api(`/breeding/eggs?start_date=${startDate}&end_date=${endDate}`),
        api(`/breeding/prepupae?start_date=${startDate}&end_date=${endDate}`),
        api(`/breeding/egg-prediction?start_date=${startDate}&end_date=${endDate}`),
      ]);
      if (!eggs) return;

      const predSummary = prediction?.summary || {};
      const accuracyColor = predSummary.accuracy ? (Math.abs(parseFloat(predSummary.variancePct)) < 15 ? '--green' : '--yellow') : '--text-3';
      const varianceSign = predSummary.variance >= 0 ? '+' : '';

      document.getElementById('breeding-stats').innerHTML = `
        ${statCard('Total Eggs', n(eggs.summary.total_eggs,0), eggs.summary.total_collections+' collections', '--green')}
        ${statCard('Egg Weight', n(eggs.summary.total_weight,1)+'g', 'avg '+n(eggs.summary.avg_weight,1)+'g/day', '--teal')}
        ${statCard('Predicted Eggs', n(predSummary.totalPredicted||0,0), 'from model', '--purple')}
        ${statCard('Model Accuracy', predSummary.accuracy?predSummary.accuracy+'%':'N/A', predSummary.variance!=null?varianceSign+n(predSummary.variance,0)+' variance':'', accuracyColor)}
        ${statCard('Pre-Pupae Collected', n(prepupae.summary.total_collected,0), prepupae.summary.total_entries+' entries', '--amber')}
        ${statCard('Mortality Rate', n(prepupae.summary.mortality_rate,1)+'%', n(prepupae.summary.total_dead,0)+' dead', parseFloat(prepupae.summary.mortality_rate)>10?'--red':'--green')}
      `;

      if (prediction?.timeline && prediction.timeline.length) {
        const tl = prediction.timeline;
        const actualPointColors = tl.map(d => {
          if (d.actual > 0 && d.isInterpolated) return '#ef4444';
          if (d.actual > 0 && d.isReal) return '#22c55e';
          return 'transparent';
        });
        const actualPointRadii = tl.map(d => d.actual > 0 ? 5 : 0);
        makeChart('chart-egg-prediction', 'line', {
          labels: tl.map(d => shortDate(d.date)),
          datasets: [
            { label: 'Actual Eggs', data: tl.map(d => d.actual > 0 ? d.actual : null), borderColor: '#22c55e', fill: false, tension: 0.3, pointRadius: actualPointRadii, pointBackgroundColor: actualPointColors, pointBorderColor: actualPointColors, pointBorderWidth: 2, borderWidth: 2.5, spanGaps: true },
            { label: 'Predicted Eggs', data: tl.map(d => d.predicted > 0 ? d.predicted : null), borderColor: '#818cf8', fill: false, borderDash: [6, 3], tension: 0.3, pointRadius: 3, pointBackgroundColor: '#818cf8', borderWidth: 2, spanGaps: true },
          ]
        }, { y: { beginAtZero: true, title: { display: true, text: 'Egg Count' } } });
      }

      if (eggs.daily && eggs.daily.length) {
        makeChart('chart-eggs', 'bar', {
          labels: eggs.daily.map(d => shortDate(d.date)),
          datasets: [
            { label: 'Eggs', data: eggs.daily.map(d => parseInt(d.total_eggs)), backgroundColor: 'rgba(34,197,94,0.6)', borderRadius: 4, yAxisID: 'y' },
            { label: 'Weight (g)', data: eggs.daily.map(d => parseFloat(d.total_weight)), type: 'line', borderColor: '#2dd4bf', backgroundColor: 'transparent', tension: 0.3, pointRadius: 3, yAxisID: 'y1' },
          ]
        }, { y: { position: 'left', title: { display: true, text: 'Egg Count' } }, y1: { position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Weight (g)' } } });
      }

      if (prepupae.daily && prepupae.daily.length) {
        makeChart('chart-prepupae', 'bar', {
          labels: prepupae.daily.map(d => shortDate(d.date)),
          datasets: [
            { label: 'Alive', data: prepupae.daily.map(d => parseInt(d.total_alive)), backgroundColor: 'rgba(234,179,8,0.6)', borderRadius: 4 },
            { label: 'Dead', data: prepupae.daily.map(d => parseInt(d.total_dead)), backgroundColor: 'rgba(239,68,68,0.6)', borderRadius: 4 },
          ]
        }, { x: { stacked: true }, y: { stacked: true } });
      }

      if (prepupae.byShelf && prepupae.byShelf.length) {
        makeChart('chart-shelf-mortality', 'bar', {
          labels: prepupae.byShelf.map(s => 'S' + s.shelf_number),
          datasets: [
            { label: 'Collected', data: prepupae.byShelf.map(s => parseInt(s.total_collected)), backgroundColor: 'rgba(234,179,8,0.5)', borderRadius: 3 },
            { label: 'Dead', data: prepupae.byShelf.map(s => parseInt(s.total_dead)), backgroundColor: 'rgba(239,68,68,0.7)', borderRadius: 3 },
          ]
        });
      }

      hide('breeding-loading'); show('breeding-content');
    } catch (err) {
      console.error('Breeding load error:', err);
      document.getElementById('breeding-loading').innerHTML = '<div style="color:var(--red)">Failed to load breeding data</div>';
    }
  }

  // ============================================================
  // DEMAND FORECAST
  // ============================================================
  async function loadForecast() {
    show('forecast-loading'); hide('forecast-content');
    try {
      const [summary, planner, history, chewy] = await Promise.all([
        api('/forecast/summary'),
        api('/forecast/pour-planner'),
        api('/forecast/history'),
        api('/forecast/chewy'),
      ]);
      if (!summary) return;

      // KPI cards
      const pourColor = summary.pourRecommendation > 0 ? 'green' : 'text-3';
      document.getElementById('forecast-kpis').innerHTML = `
        ${kpiCard('Pour This Wed', n(summary.pourRecommendation, 0)+' cups', 'includes 10% buffer + 76 shrinkage', pourColor, 'orange')}
        ${kpiCard('Weekly Demand', n(summary.weeklyDemand, 0)+' cups', 'all channels combined', 'green', 'green')}
        ${kpiCard('Monthly Demand', n(summary.totalMonthlyDemand, 0)+' cups', 'Chewy '+n(summary.channels.chewy.monthly,0)+' · Amz '+n(summary.channels.amazon.monthly,0)+' · Shop '+n(summary.channels.shopify.monthly,0), 'green', 'blue')}
        ${kpiCard('Recent Output', n(summary.recentPours.totalSellable, 0)+' cups', summary.recentPours.pourCount+' pours last 4 weeks', 'green', 'teal')}
      `;

      // Pour planner cards (next 4 Wednesdays)
      if (planner?.wednesdays) {
        document.getElementById('forecast-planner').innerHTML = planner.wednesdays.map((w, i) => {
          const dateLabel = new Date(w.date + 'T12:00:00').toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' });
          const accent = i === 0 ? '--orange' : '--text-2';
          return `<div class="stat-card" style="${i===0?'border:1px solid var(--orange);background:rgba(251,146,60,0.04)':''}">
            <div class="stat-label" style="${i===0?'color:var(--orange)':''}">${dateLabel}</div>
            <div class="stat-value" style="color:var(${accent})">${n(w.pourTarget,0)}</div>
            <div class="stat-sub">
              <span style="color:var(--chewy)">Chewy ${n(w.chewyDemand,0)}</span> ·
              <span style="color:var(--amazon)">Amz ${n(w.amazonDemand,0)}</span> ·
              <span style="color:var(--shopify)">Shop ${n(w.shopifyDemand,0)}</span>
              <br>+${n(w.safetyBuffer,0)} safety +${w.shrinkage} shrink
            </div>
          </div>`;
        }).join('');
      }

      // Chewy forecast bar chart
      if (chewy?.monthly && chewy.monthly.length) {
        makeChart('chart-chewy-forecast', 'bar', {
          labels: chewy.monthly.map(m => {
            const d = new Date(m.forecast_month);
            return d.toLocaleDateString('en-US', { month: 'short', year: '2-digit' });
          }),
          datasets: [{
            label: 'Physical Cups',
            data: chewy.monthly.map(m => parseInt(m.total_cups)),
            backgroundColor: 'rgba(28,73,194,0.6)',
            borderRadius: 4,
          }]
        }, { y: { beginAtZero: true, title: { display: true, text: 'Cups' } } });
      }

      // Channel demand doughnut
      const ch = summary.channels;
      if (ch.chewy.monthly > 0 || ch.amazon.monthly > 0 || ch.shopify.monthly > 0) {
        makeChart('chart-demand-split', 'doughnut', {
          labels: ['Chewy', 'Amazon', 'Shopify'],
          datasets: [{
            data: [ch.chewy.monthly, ch.amazon.monthly, ch.shopify.monthly],
            backgroundColor: ['rgba(28,73,194,0.7)', 'rgba(255,153,0,0.7)', 'rgba(150,191,72,0.7)'],
            borderWidth: 0,
          }]
        }, {}, { cutout: '68%' });
      }

      // Pour history chart
      if (history?.pours && history.pours.length) {
        const pours = history.pours.sort((a,b) => a.pour_date > b.pour_date ? 1 : -1);
        makeChart('chart-pour-history', 'bar', {
          labels: pours.map(p => shortDate(p.pour_date.split('T')[0])),
          datasets: [
            {
              label: 'Sellable Cups',
              data: pours.map(p => parseInt(p.sellable_cups)),
              backgroundColor: 'rgba(34,197,94,0.5)',
              borderRadius: 4,
            },
            {
              label: 'Shrinkage (76)',
              data: pours.map(() => 76),
              backgroundColor: 'rgba(239,68,68,0.25)',
              borderRadius: 4,
            },
          ]
        }, { x: { stacked: true }, y: { stacked: true, beginAtZero: true, title: { display: true, text: 'Cups' } } });
      }

      // Amazon trend chart
      if (history?.amazon && history.amazon.length) {
        const amz = history.amazon.sort((a,b) => a.sales_month > b.sales_month ? 1 : -1);
        makeChart('chart-amazon-trend', 'bar', {
          labels: amz.map(m => {
            const d = new Date(m.sales_month);
            return d.toLocaleDateString('en-US', { month: 'short', year: '2-digit' });
          }),
          datasets: [
            {
              label: 'Units',
              data: amz.map(m => parseInt(m.units_sold)),
              backgroundColor: 'rgba(255,153,0,0.6)',
              borderRadius: 4,
              yAxisID: 'y',
            },
            {
              label: 'Revenue',
              data: amz.map(m => parseFloat(m.revenue)),
              type: 'line',
              borderColor: '#fb923c',
              backgroundColor: 'transparent',
              tension: 0.3,
              pointRadius: 4,
              pointBackgroundColor: '#fb923c',
              yAxisID: 'y1',
              borderWidth: 2,
            },
          ]
        }, {
          y: { position: 'left', beginAtZero: true, title: { display: true, text: 'Units' } },
          y1: { position: 'right', grid: { drawOnChartArea: false }, title: { display: true, text: 'Revenue ($)' } },
        });
      }

      // Forecast Accuracy table + chart
      try {
        const acc = await api('/forecast/accuracy?weeks=12');
        if (acc?.accuracy && acc.accuracy.length > 0) {
          const rows = acc.accuracy.sort((a,b) => a.weekStart > b.weekStart ? 1 : -1);
          let tableHtml = `<table style="width:100%;border-collapse:collapse;font-size:13px">
            <thead><tr style="border-bottom:2px solid var(--border);text-align:left">
              <th style="padding:8px 6px">Week</th>
              <th style="padding:8px 6px;color:var(--chewy)">Chewy</th>
              <th style="padding:8px 6px;color:var(--amazon)">Amazon</th>
              <th style="padding:8px 6px;color:var(--shopify)">Shopify<br><span style="font-weight:400;font-size:11px">Fcst → Actual</span></th>
              <th style="padding:8px 6px">Total Fcst</th>
              <th style="padding:8px 6px">Pour Rec</th>
              <th style="padding:8px 6px">Actually Poured</th>
              <th style="padding:8px 6px">Variance</th>
            </tr></thead><tbody>`;
          for (const r of rows) {
            const wkLabel = new Date(r.weekStart+'T12:00:00').toLocaleDateString('en-US',{month:'short',day:'numeric'});
            const shopFcst = r.forecast.shopify;
            const shopActual = r.actual.shopifyCups;
            const shopDiff = r.variance.shopifyVsForecast;
            const shopColor = shopDiff >= 0 ? 'var(--green)' : 'var(--red)';
            const pourDiff = r.variance.pouredVsRecommended;
            const pourColor = pourDiff >= 0 ? 'var(--green)' : 'var(--red)';
            const pctColor = Math.abs(r.variance.overallPct) <= 15 ? 'var(--green)' : Math.abs(r.variance.overallPct) <= 30 ? 'var(--orange)' : 'var(--red)';
            tableHtml += `<tr style="border-bottom:1px solid var(--border)">
              <td style="padding:6px">${wkLabel}</td>
              <td style="padding:6px">${n(r.forecast.chewy,0)}</td>
              <td style="padding:6px">${n(r.forecast.amazon,0)}</td>
              <td style="padding:6px">${n(shopFcst,0)} → <b>${n(shopActual,0)}</b> <span style="color:${shopColor};font-size:11px">${shopDiff>=0?'+':''}${shopDiff}</span></td>
              <td style="padding:6px"><b>${n(r.forecast.totalDemand,0)}</b></td>
              <td style="padding:6px">${n(r.forecast.pourRecommended,0)}</td>
              <td style="padding:6px">${r.actual.cupsPoured > 0 ? n(r.actual.cupsPoured,0) : '—'} ${r.actual.cupsPoured > 0 ? '<span style="color:'+pourColor+';font-size:11px">'+(pourDiff>=0?'+':'')+pourDiff+'</span>' : ''}</td>
              <td style="padding:6px;color:${pctColor};font-weight:600">${r.variance.overallPct >= 0 ? '+' : ''}${r.variance.overallPct}%</td>
            </tr>`;
          }
          tableHtml += '</tbody></table>';
          document.getElementById('forecast-accuracy').innerHTML = tableHtml;

          // Accuracy chart: forecast vs actual poured
          makeChart('chart-accuracy', 'bar', {
            labels: rows.map(r => {
              const d = new Date(r.weekStart+'T12:00:00');
              return d.toLocaleDateString('en-US',{month:'short',day:'numeric'});
            }),
            datasets: [
              {
                label: 'Forecasted Demand',
                data: rows.map(r => r.forecast.totalDemand),
                backgroundColor: 'rgba(99,102,241,0.4)',
                borderRadius: 4,
              },
              {
                label: 'Pour Recommended',
                data: rows.map(r => r.forecast.pourRecommended),
                backgroundColor: 'rgba(251,146,60,0.4)',
                borderRadius: 4,
              },
              {
                label: 'Actually Poured',
                data: rows.map(r => r.actual.cupsPoured || 0),
                backgroundColor: 'rgba(34,197,94,0.5)',
                borderRadius: 4,
              },
              {
                label: 'Shopify Actual',
                data: rows.map(r => r.actual.shopifyCups),
                type: 'line',
                borderColor: '#96bf48',
                backgroundColor: 'transparent',
                tension: 0.3,
                pointRadius: 4,
                pointBackgroundColor: '#96bf48',
                borderWidth: 2,
              },
            ]
          }, { y: { beginAtZero: true, title: { display: true, text: 'Cups' } } });
        } else {
          document.getElementById('forecast-accuracy').innerHTML = '<div style="color:var(--text-3);padding:16px">No accuracy data yet. Snapshots are saved nightly — data will appear after the first week.</div>';
        }
      } catch (accErr) {
        console.warn('Accuracy data not available:', accErr);
        document.getElementById('forecast-accuracy').innerHTML = '<div style="color:var(--text-3);padding:16px">Accuracy tracking will start after migration and first nightly snapshot.</div>';
      }

      hide('forecast-loading'); show('forecast-content');
    } catch (err) {
      console.error('Forecast load error:', err);
      document.getElementById('forecast-loading').innerHTML = '<div style="color:var(--red)">Failed to load forecast data. Run migration first: POST /dashboard/api/forecast/migrate</div>';
    }
  }

  // ============================================================
  // CHART HELPERS
  // ============================================================
  function makeChart(id, type, data, scaleOpts = {}, extraOpts = {}) {
    if (charts[id]) charts[id].destroy();
    const ctx = document.getElementById(id)?.getContext('2d');
    if (!ctx) return;
    const isMobile = window.innerWidth < 768;
    const isDoughnut = type === 'doughnut';
    charts[id] = new Chart(ctx, {
      type, data,
      options: {
        responsive: true, maintainAspectRatio: false,
        interaction: { intersect: false, mode: isDoughnut ? 'nearest' : 'index' },
        plugins: {
          legend: { display: true, position: isDoughnut ? (isMobile ? 'bottom' : 'right') : 'top', labels: { boxWidth: isMobile ? 8 : 10, padding: isMobile ? 8 : 12, font: { size: isMobile ? 10 : 11 } } },
          tooltip: { backgroundColor: '#0f1520', borderColor: '#1a2235', borderWidth: 1, titleColor: '#e2e8f0', bodyColor: '#94a3b8', padding: 10, cornerRadius: 6 },
        },
        scales: isDoughnut ? {} : scaleOpts,
        ...extraOpts,
      },
    });
  }

  // ============================================================
  // UTILITY
  // ============================================================
  function kpiCard(label, value, sub, statusColor, accentColor) {
    return `<div class="kpi">
      <div class="kpi-top"><span class="kpi-label">${label}</span><span class="kpi-status" style="background:var(--${statusColor})"></span></div>
      <div class="kpi-value" style="color:var(--${accentColor||statusColor})">${value}</div>
      <div class="kpi-bottom"><span class="kpi-sub">${sub||''}</span></div>
      <div class="kpi-accent" style="background:linear-gradient(90deg,var(--${accentColor||statusColor}),transparent)"></div>
    </div>`;
  }

  function statCard(label, value, sub, colorVar) {
    return `<div class="stat-card">
      <div class="stat-label">${label}</div>
      <div class="stat-value" style="color:var(${colorVar})">${value}</div>
      ${sub ? `<div class="stat-sub">${sub}</div>` : ''}
    </div>`;
  }

  function n(val, decimals = 2) {
    const num = parseFloat(val) || 0;
    if (decimals === 0) return Math.round(num).toLocaleString();
    return num.toLocaleString(undefined, { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
  }

  function shortDate(d) { const p = d.split('-'); return parseInt(p[1]) + '/' + parseInt(p[2]); }
  function channelLabel(ch) {
    const labels = { retail: 'Website', wholesale: 'Wholesale', chewy: 'Chewy', 'amazon-pioneer': 'Amazon Pioneer', 'amazon-upnorth': 'Amazon UP North', ebay: 'eBay', tradeshow: 'Trade Show' };
    return labels[ch] || ch;
  }
  function show(id) { document.getElementById(id).style.display = ''; }
  function hide(id) { document.getElementById(id).style.display = 'none'; }

  (function init() {
    pickPreset('7d', document.querySelector('.dd-preset'));
  })();
</script>
</body>
</html>
